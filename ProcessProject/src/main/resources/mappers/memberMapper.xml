<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 다른 mapper와 중복되지 않도록 네임스페이스 기재 -->
<mapper namespace="member">
	<!-- 01. 회원목록 -->
	<select id="memberList" resultType="com.edu.domain.MemberVO">
		SELECT 
			emp_code,
			id,
			name_kor,
			name_eng,
			email,
			phone_number,
			birth,
			org_code,
			department_id,
			branch_id,
			position,
			hire_date
		FROM EMPLOYEES
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="searchType=='emp_code' and keyword != null and keyword != '' ">
				AND emp_code like CONCAT('%', #{keyword}, '%')
			</if>
			<if test="searchType=='id' and keyword != null and keyword != '' ">
				AND id like CONCAT('%', #{keyword}, '%')
			</if>
			<if test="searchType=='name_kor' and keyword != null and keyword != '' ">
				AND name_kor like CONCAT('%', #{keyword}, '%')
			</if>	
			<if test="searchType=='email' and keyword != null and keyword != '' ">
				AND email like CONCAT('%', #{keyword}, '%')
			</if>
			<if test="searchType=='department_id' and keyword != null and keyword != '' ">
				AND department_id like CONCAT('%', #{keyword}, '%')
			</if>
			<if test="searchType=='branch_id' and keyword != null and keyword != '' ">
				AND branch_id like CONCAT('%', #{keyword}, '%')
			</if>	
			<if test="searchType=='position' and keyword != null and keyword != '' ">
				AND position like CONCAT('%', #{keyword}, '%')
			</if>	
		</trim>
		
		LIMIT #{startList}, #{listSize}
	</select>
	
	<select id="modalmemberList" resultType="com.edu.domain.MemberVO">
		SELECT 
			emp_code,
			id,
			name_kor,
			name_eng,
			email,
			phone_number,
			birth,
			org_code,
			department_id,
			branch_id,
			position,
			hire_date, 
			status
		FROM EMPLOYEES
		WHERE emp_code= #{emp_code}
		
	</select>
	
	<select id="getBoardListCnt" resultType="int">

		SELECT
			count(*) as listCnt
		FROM
			EMPLOYEES
			<trim prefix="WHERE" prefixOverrides="AND|OR">
				<if test="keyword != null and keyword != '' ">
					<if test="searchType=='emp_code'">
						AND emp_code like CONCAT('%', #{keyword}, '%')
					</if>
					<if test="searchType=='id'">
						AND id like CONCAT('%', #{keyword}, '%')
					</if>
					<if test="searchType=='name_kor'">
						AND name_kor like CONCAT('%', #{keyword}, '%')
					</if>
					<if test="searchType=='email'">
						AND email like CONCAT('%', #{keyword}, '%')
					</if>
					<if test="searchType=='department_id'">
						AND department_id like CONCAT('%', #{keyword}, '%')
					</if>
					<if test="searchType=='branch_id'">
						AND branch_id like CONCAT('%', #{keyword}, '%')
					</if>
					<if test="searchType=='position'">
						AND position like CONCAT('%', #{keyword}, '%')
					</if>
	      		</if>
			</trim>
	</select>

	
	<!-- 02. 회원 등록 -->
	<insert id="insertMember">
		INSERT INTO example
			(emp_code, id, password, name_kor, name_eng, email,phone_number,birth,org_code,department_id,branch_id,position,hire_date)
		VALUES 
			(#{emp_code}, #{id}, #{password}, #{name_kor}, #{name_eng}, #{email}, #{phone_number}, #{birth}, #{org_code},#{department_id}, #{branch_id},#{position},#{hire_date})	
	</insert>
	
	<!-- 03. 회원정보 상세조회 -->
	<select id="viewMember" resultType="com.edu.domain.MemberVO">
		SELECT 
		  emp_code,
		  id,
		  name_kor,
		  name_eng,
		  email,
		  phone_number,
		  birth,
		  org_code,
		  department_id,
		  branch_id,
		  position,
		  hire_date
		FROM EMPLOYEES
		WHERE id = #{id}
	</select>
	
	

</mapper>
